jQuery(document).ready(function($){"use strict";function initEnhancements(){renameUIElements();enhanceSunRequirements();setupConfirmationFlow();improveFormFields();addAnimations()}function renameUIElements(){$("label").each(function(){const $label=$(this);const text=$label.text().trim();if(text==="Seed Categories"){$label.text("Seed Category")}});$(".esc-button-primary").each(function(){const $button=$(this);const buttonText=$button.text().trim();if(buttonText==="Save Seed"){$button.html('<span class="dashicons dashicons-saved"></span> Submit Seed');$button.attr("id","esc-submit-seed")}})}function enhanceSunRequirements(){return}function setupConfirmationFlow(){if($(".esc-confirmation-container").length===0){const confirmationHTML=`
                <div class="esc-confirmation-container">
                    <div class="esc-confirmation-message">
                        <div class="esc-confirmation-icon">
                            <span class="dashicons dashicons-yes-alt"></span>
                        </div>
                        <h2 class="esc-confirmation-title">Seed Submitted Successfully!</h2>
                        <p class="esc-confirmation-text">Your seed has been added to the catalog.</p>
                        <div class="esc-confirmation-actions">
                            <button class="esc-confirmation-button esc-view-catalog">View Catalog</button>
                            <button class="esc-confirmation-button esc-add-another">Add Another Seed</button>
                        </div>
                    </div>
                </div>
            `;$("body").append(confirmationHTML)}window.escIsSubmitting=window.escIsSubmitting||false;console.log("Setting up submit button handler for:",$("#esc-submit-seed").length?"Found button":"Button not found");$("#esc-submit-seed").off("click").on("click",function(e){console.log("Submit button clicked");e.preventDefault();const $form=$("#esc-add-seed-form");const $messageDiv=$("#esc-form-messages");if(window.escIsSubmitting){console.log("Form already submitting, preventing duplicate submission");return}$('input[data-target]').each(function(){const value=$(this).val();const targetId=$(this).data("target");if(value){$("#"+targetId).val(value)}});const seedNameValue=$("#esc_seed_name_hidden").val();console.log("Seed Name Value:",seedNameValue);if(!seedNameValue){$messageDiv.removeClass("loading").addClass("error").text("Seed Type is required.").show();return}window.escIsSubmitting=true;var formData=$form.serialize();console.log("Form data:",formData);formData+="&action=esc_add_seed&nonce="+esc_ajax_object.nonce;$messageDiv.empty().removeClass("success error").addClass("loading").text("Saving...").show();$(this).prop("disabled",true);$.ajax({url:esc_ajax_object.ajax_url,type:"POST",data:formData,dataType:"json",success:function(response){console.log("AJAX success:",response);if(response.success){$messageDiv.hide();$(".esc-confirmation-container").addClass("active");$(".esc-add-another").off("click").on("click",function(){$(".esc-confirmation-container").removeClass("active");$form[0].reset();$("#esc_seed_name_hidden, #esc_variety_name_hidden").val("");$(".esc-phase").hide();$("#esc-phase-ai-input").show();window.escIsSubmitting=false;$("#esc-submit-seed").prop("disabled",false)});$(".esc-view-catalog").off("click").on("click",function(){window.location.href=esc_ajax_object.catalog_url||"/"})}else{let errorMsg=response.data.message||"Error adding seed.";$messageDiv.removeClass("loading").addClass("error").text(errorMsg);console.error("Add Seed Error:",response.data);window.escIsSubmitting=false;$("#esc-submit-seed").prop("disabled",false)}},error:function(_,textStatus,errorThrown){console.error("AJAX Error:",textStatus,errorThrown);$messageDiv.removeClass("loading").addClass("error").text("An error occurred: "+textStatus);window.escIsSubmitting=false;$("#esc-submit-seed").prop("disabled",false)}})});console.log("Setting up form submit handler for:",$("#esc-add-seed-form").length?"Found form":"Form not found");$("#esc-add-seed-form").off("submit").on("submit",function(e){console.log("Form submitted directly");e.preventDefault();$("#esc-submit-seed").trigger("click")})}function improveFormFields(){$(".esc-form-field input, .esc-form-field textarea").each(function(){const $input=$(this);const $label=$input.closest(".esc-form-field").find("label");if(!$input.attr("placeholder")&&$label.length){const labelText=$label.text().trim();$input.attr("placeholder",`Enter ${labelText.toLowerCase()}...`)}});$(".esc-form-field input, .esc-form-field textarea, .esc-form-field select").on("focus",function(){$(this).closest(".esc-form-field").addClass("esc-field-focused")}).on("blur",function(){$(this).closest(".esc-form-field").removeClass("esc-field-focused")})}function addAnimations(){$(".esc-form-card").each(function(index){const $card=$(this);$card.css({"animation-delay":(index*0.1)+"s","animation-name":"fadeIn","animation-duration":"0.5s","animation-fill-mode":"both"})})}$(function(){initEnhancements()});document.addEventListener("DOMContentLoaded",function(){console.log("DOMContentLoaded event fired");var submitButton=document.getElementById("esc-submit-seed");var form=document.getElementById("esc-add-seed-form");if(submitButton){console.log("Found submit button with vanilla JS");submitButton.addEventListener("click",function(e){console.log("Submit button clicked with vanilla JS");e.preventDefault();if(form){form.dispatchEvent(new Event("submit"))}})}else{console.log("Submit button not found with vanilla JS")}if(form){console.log("Found form with vanilla JS");form.addEventListener("submit",function(e){console.log("Form submitted with vanilla JS");e.preventDefault();jQuery(form).trigger("submit")})}else{console.log("Form not found with vanilla JS")}});$(document).ajaxComplete(function(_,__,settings){if(settings.data&&settings.data.includes("esc_gemini_search")){setTimeout(function(){initEnhancements()},300)}})});
